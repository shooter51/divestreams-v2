name: Rename B2 secrets to S3

on:
  workflow_dispatch:

jobs:
  rename-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Copy B2 secrets to S3 names
        env:
          GH_TOKEN: ${{ secrets.PROMOTION_PAT }}
          B2_ENDPOINT: ${{ secrets.B2_ENDPOINT }}
          B2_REGION: ${{ secrets.B2_REGION }}
          B2_BUCKET: ${{ secrets.B2_BUCKET }}
          B2_KEY_ID: ${{ secrets.B2_KEY_ID }}
          B2_APP_KEY: ${{ secrets.B2_APP_KEY }}
        run: |
          echo "Copying B2 secrets to S3 names..."
          echo "$B2_ENDPOINT" | gh secret set S3_ENDPOINT --repo ${{ github.repository }}
          echo "$B2_REGION" | gh secret set S3_REGION --repo ${{ github.repository }}
          echo "$B2_BUCKET" | gh secret set S3_BUCKET --repo ${{ github.repository }}
          echo "$B2_KEY_ID" | gh secret set S3_ACCESS_KEY_ID --repo ${{ github.repository }}
          echo "$B2_APP_KEY" | gh secret set S3_SECRET_ACCESS_KEY --repo ${{ github.repository }}
          echo "Done! New secrets created:"
          echo "  S3_ENDPOINT"
          echo "  S3_REGION"
          echo "  S3_BUCKET"
          echo "  S3_ACCESS_KEY_ID"
          echo "  S3_SECRET_ACCESS_KEY"
          echo ""
          echo "You can now delete the old B2_ secrets manually."
