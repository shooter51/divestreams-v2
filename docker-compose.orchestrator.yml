services:
  orchestrator:
    image: ghcr.io/shooter51/divestreams-orchestrator:latest
    container_name: orchestrator
    restart: unless-stopped
    ports:
      - "80:4000"
    volumes:
      - orchestrator-data:/app/data
    environment:
      - NODE_ENV=production
      - PORT=4000
      - HOST=0.0.0.0
      - DATABASE_PATH=/app/data/orchestrator.db
      - DRY_RUN=${DRY_RUN:-true}
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - WEBHOOK_SECRET=${WEBHOOK_SECRET}
      - GITHUB_OWNER=shooter51
      - GITHUB_REPO=divestreams-v2
      - ORCHESTRATOR_TOKEN=${ORCHESTRATOR_TOKEN}
      - VK_BASE_URL=${VK_BASE_URL:-https://toms-mac-studio-1.taile2f004.ts.net:9090}
      - VK_PROJECT_ID=${VK_PROJECT_ID:-500e93c8-662d-4f9e-8745-ac4c259ead3c}
      - VK_REPO_ID=${VK_REPO_ID:-2e2baa81-971b-4735-a0cc-d445d4338e00}
      - HOSTINGER_API_TOKEN=${HOSTINGER_API_TOKEN}
      - DEV_VPS_ID=${DEV_VPS_ID:-1296511}
      - TEST_VPS_ID=${TEST_VPS_ID:-1271895}
      - PROD_VPS_ID=${PROD_VPS_ID:-1239852}
      - MAX_FIX_CYCLES=${MAX_FIX_CYCLES:-3}
      - AGENT_TIMEOUT_MS=${AGENT_TIMEOUT_MS:-900000}
      - AGENT_POLL_INTERVAL_MS=${AGENT_POLL_INTERVAL_MS:-30000}
      - LOG_LEVEL=${LOG_LEVEL:-info}

volumes:
  orchestrator-data:
