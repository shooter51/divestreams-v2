# Dev VPS - System-level Caddy configuration
# Routes *.dev.divestreams.com to the app on port 3001.

{
    email admin@divestreams.com
    on_demand_tls {
        ask http://localhost:3001/api/health
    }
}

(security_headers) {
    header {
        X-Content-Type-Options nosniff
        Referrer-Policy strict-origin-when-cross-origin
        -Server
    }
}

# Base domain â€” routes to the app
dev.divestreams.com {
    import security_headers
    reverse_proxy localhost:3001
}

# Wildcard for tenant subdomains (demo.dev.divestreams.com, admin.dev.divestreams.com, etc.)
*.dev.divestreams.com {
    tls {
        on_demand
    }
    import security_headers
    reverse_proxy localhost:3001
}
